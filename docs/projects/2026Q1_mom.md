# 2026Q1_mom 项目说明

## 研究问题

本项目旨在实现一个基于动量策略的量化投资组合，主要研究：

- 动量效应是否在A股市场存在
- 20日收益率作为动量指标的有效性
- 5日调仓频率的表现
- Top-N选股策略的最优参数

## Universe 定义

### 标的范围
- **仅沪深主板**：股票代码以0或6开头，排除科创板（688/689开头）
- **剔除ST股票**：通过股票名称判断，排除包含ST/*ST/退等标记的股票
- **剔除创业板**：天然排除3开头的股票
- **剔除北交所股票**：排除8/4开头的股票

### 数据来源
- 股票列表：通过AKShare获取全市场A股代码和名称
- 过滤逻辑：基于股票代码前缀和名称进行过滤

### 局限性
- 当前使用静态快照过滤ST股票，未考虑历史ST状态变化
- 未考虑股票停牌和涨跌停限制

## 数据处理

### 数据存储
- 行情数据存储在SQLite数据库：`data/market.db`
- 股票列表存储在：`data/meta/symbols.csv`
- 包含字段：symbol, name, is_st, board

### 数据频率
- 日线数据（1d）
- 前复权价格

## 信号生成

### 动量定义
- **20日收益率**：`动量 = close[t]/close[t-20] - 1`
- 计算方法：使用过去20个交易日的收盘价计算收益率

### 排名规则
- 每个调仓日，计算所有universe内股票的20日收益率
- 按收益率从高到低排序
- 选择Top-K股票（K=5）

### 调仓规则
- **调仓频率**：每5个交易日调仓一次
- **权重分配**：等权分配（1/K）
- **成本考虑**：佣金 + 印花税（卖出） + 滑点

## 回测参数

### 成本假设
- **佣金**：0.03%（双边）
- **印花税**：0.1%（仅卖出）
- **滑点**：0.05%

### 初始资金
- 1,000,000元

### 回测范围
- 基于数据库中可用的历史数据
- 支持自动构建交易日历

## 结果评估

### 输出结果
- 净值曲线：`artifacts/projects/2026Q1_mom/topn_1_5.png`
- 包含Top1到Top5策略的对比
- 归一化净值曲线，便于比较不同策略表现

### 评估指标
- 累计收益率
- 年化收益率
- 最大回撤
- Sharpe比率（需额外计算）

## 项目结构

### 配置文件
- `configs/projects/2026Q1_mom.json`：项目参数配置

### 核心脚本
1. **10_symbols.py**：生成股票列表，包含ST过滤和板块分类
2. **11_update_bars.py**：数据访问和rank生成
3. **30_bt_rebalance.py**：回测执行（当前集成在11_update_bars.py中）

### 输出路径
- **信号文件**：`data/projects/2026Q1_mom/signals/rank_top5.parquet`
- **回测结果**：`artifacts/projects/2026Q1_mom/`

## 运行方式

### 生成股票列表
```bash
python scripts/steps/10_symbols.py
```

### 运行回测
```bash
python scripts/steps/11_update_bars.py --project 2026Q1_mom --no-show
```

### 查看结果
- 生成的净值曲线：`artifacts/projects/2026Q1_mom/topn_1_5.png`

## 已知局限

1. **ST股票过滤**：当前使用静态快照，未考虑历史ST状态变化
2. **交易限制**：未考虑股票停牌、涨跌停限制等实际交易约束
3. **幸存者偏差**：仅使用当前存在的股票进行回测
4. **数据质量**：依赖于AKShare和本地数据库的数据质量
5. **回测引擎**：使用backtrader，可能存在精度和效率问题

## 下一步改进方向

1. **更严格的可交易性约束**：考虑停牌、涨跌停等限制
2. **更稳健的评估指标**：添加Sharpe比率、最大回撤等指标
3. **ST股票历史状态**：实现按日期的ST状态快照
4. **多因子策略**：结合多个因子进行选股
5. **参数优化**：对lookback、rebalance_every等参数进行优化
6. **实盘模拟**：添加模拟交易功能

## 结论

本项目实现了一个基于动量策略的量化投资组合，包含完整的数据处理、信号生成和回测流程。通过调整参数和优化策略，可以进一步提高策略的表现。