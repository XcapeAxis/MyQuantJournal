# 2026Q1\_mom项目功能完善计划

## 1. 项目配置文件创建

创建 `configs/projects/2026Q1_mom.json` 配置文件，包含项目所需的所有参数：

* 频率：1d

* 日历代码：000001

* 动量计算：lookback=20

* 调仓规则：每5个交易日，topk=5

* 成本参数：沿用现有设定

* 自动构建rank：启用

## 2. 完善symbols生成脚本

修改 `scripts/steps/10_symbols.py`，添加ST过滤功能：

* 从AKShare获取股票名称

* 添加is\_st字段，通过名称判断是否为ST（包含ST/\*ST/退等标记）

* 添加board字段，明确区分mainboard/chinext/star/bse

* 确保输出的symbols.csv包含：symbol, name, is\_st, board

## 3. Universe构建脚本

确保 `10_symbols.py` 实现完整的universe构建：

* 仅包含沪深主板（0/6开头，排除688/689）

* 剔除ST股票（is\_st=False）

* 剔除创业板（3开头）

* 输出到 `data/meta/symbols.csv`

## 4. 修改bars更新脚本

修改 `11_update_bars.py`（实际是数据访问层）：

* 在 `list_db_codes` 函数中添加ST过滤

* 确保rank生成时只使用universe内的股票

* 优化rank生成的性能，支持SQL批量查询

## 5. 优化rank生成逻辑

在 `build_rank_topk_from_db` 函数中：

* 确保动量计算正确：20日收益率 = close\[t]/close\[t-20] - 1

* 每5个交易日调仓一次

* 选topk=5（按动量从高到低）

* 确保rank输出到 `data/projects/2026Q1_mom/signals/rank_top5.parquet`

## 6. 确保回测输出符合要求

验证回测脚本：

* 确保回测结果输出到 `artifacts/projects/2026Q1_mom/`

* 支持 --no-show 参数，自动保存图片

* 确保等权分配（1/K）

## 7. 创建项目文档

创建 `docs/projects/2026Q1_mom.md` 文档：

* 研究问题说明

* Universe定义与过滤规则

* 信号计算方法

* 回测参数与成本假设

* 结果评估与局限说明

## 8. 测试与验证

运行完整流程验证：

1. 生成symbols：`python scripts/steps/10_symbols.py`
2. 构建rank：`python scripts/steps/11_update_bars.py --project 2026Q1_mom --auto-build-rank 1`
3. 运行回测：`python scripts/steps/11_update_bars.py --project 2026Q1_mom --no-show`
4. 验证输出文件位置与内容

## 关键技术点

1. **ST过滤**：通过股票名称判断是否为ST
2. **Universe管理**：确保只使用符合条件的股票
3. **性能优化**：考虑批量SQL查询提高rank生成效率
4. **项目隔离**：确保各项目输出相互独立
5. **可追溯性**：确保git status干净，只有配置和代码进git

## 预期输出

* 配置文件：`configs/projects/2026Q1_mom.json`

* 符号列表：`data/meta/symbols.csv`

* Rank文件：`data/projects/2026Q1_mom/signals/rank_top5.parquet`

* 回测结果：`artifacts/projects/2026Q1_mom/topn_1_5.png`

* 项目文档：`docs/projects/2026Q1_mom.md`

